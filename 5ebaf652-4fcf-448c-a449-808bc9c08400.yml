id: 5ebaf652-4fcf-448c-a449-808bc9c08400
name: Find SUID Binaries
description: 'A simple way to find suid binaries '
tactic: privilege-escalation
technique:
  id: T1548
  name: Abuse Elevation Control Mechanism
platforms:
  linux:
    bash:
      command: >-
        eval "suidGTFO=($(cat payload.txt | tr '\n' ' '))"

        eval "suidOM=($(find / -perm -4000 -type f 2>/dev/null | sed
        's:.*/\(.*\):"\1":' | tr '\n' ' '))"

        exploitables=()

        for eSuid in ${suidGTFO[@]};do
            for suid in ${suidOM[@]};do
                if [[ "$eSuid" == *"$suid"* ]];then
                    exploitables+=("$suid")
                    fi
                done;
            done;
        for i in ${exploitables[@]};do
            echo -n '{ "suid": '\"$i\" '} '
        done;
      payload: '#{operator.payloads}/uploads/payload.txt'
metadata:
  authors:
    - gerbsec
  tags:
    - SUID GTFOBINS
  themes: []
  enabled: true
